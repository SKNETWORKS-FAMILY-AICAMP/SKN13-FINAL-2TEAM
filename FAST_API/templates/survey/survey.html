{% extends "base.html" %}

{% block content %}
    <div class="survey-container">
        <h1>관심 있는 의류 스타일을 선택해주세요.</h1>
        <p>선택하신 스타일을 기반으로 맞춤 의류를 추천해 드립니다.</p>

        <div class="style-selection-grid">
            <!-- Example Style Card -->
            <div class="style-card" data-style="casual">
                <img src="https://www.wkorea.com//wp_data/w/2022/11/style_636009562e978.jpg" alt="캐주얼 스타일">
                <div class="style-info">
                    <h3>캐주얼</h3>
                    <p>편안하고 활동적인 일상복</p>
                </div>
            </div>

            <div class="style-card" data-style="formal">
                <img src="https://static.lookpin.co.kr/20210330192824-099f/51014fa75b3522832235c4176e537505.jpg" alt="포멀 스타일">
                <div class="style-info">
                    <h3>포멀</h3>
                    <p>격식 있고 단정한 정장 스타일</p>
                </div>
            </div>

            <div class="style-card" data-style="street">
                <img src="https://static.lookpin.co.kr/20250727133517-b8d8/25271f7e54ba4d7ab2087aa7abe0ded7.jpg" alt="스트릿 스타일">
                <div class="style-info">
                    <h3>스트릿</h3>
                    <p>개성 있고 트렌디한 길거리 패션</p>
                </div>
            </div>

            <div class="style-card" data-style="vintage">
                <img src="https://news.samsungcnt.com/upload/2.0/wp-content/uploads/sites/2/2024/08/%EC%82%AC%EC%A7%84-1.-%EB%94%94-%EC%95%A0%ED%8D%BC%EC%B2%98-24%EB%85%84-%EA%B0%80%EC%9D%84-%EC%BB%AC%EB%A0%89%EC%85%98.jpg" alt="빈티지 스타일">
                <div class="style-info">
                    <h3>빈티지</h3>
                    <p>복고풍의 독특하고 개성 있는 스타일</p>
                </div>
            </div>

            <div class="style-card" data-style="sporty">
                <img src="https://www.esquirekorea.co.kr/resources_old/online/org_online_image/eq/3fda0734-4fca-48fb-8991-981ed199bd23.jpg" alt="스포티 스타일">
                <div class="style-info">
                    <h3>스포티</h3>
                    <p>활동적이고 편안한 운동복 스타일</p>
                </div>
            </div>

            <div class="style-card" data-style="minimal">
                <img src="https://images.onthelook.co.kr/p/vQwp4GprSwU9Tj12yALrqS.jpeg?w=1200&q=75&f=webp" alt="미니멀 스타일">
                <div class="style-info">
                    <h3>미니멀</h3>
                    <p>간결하고 절제된 디자인의 스타일</p>
                </div>
            </div>

            <div class="style-card" data-style="whiterook">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fe/Chess_piece_-_White_rook.JPG/330px-Chess_piece_-_White_rook.JPG" alt="직진 스타일">
                <div class="style-info">
                    <h3>화이트</h3>
                    <p>체스에서 직진만 하는 스타일</p>
                </div>
            </div>

            <div class="style-card" data-style="blackrook">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/Chess_piece_-_Black_rook.JPG/330px-Chess_piece_-_Black_rook.JPG" alt="직진 스타일">
                <div class="style-info">
                    <h3>블랙</h3>
                    <p>체스에서 직진만 하는 스타일</p>
                </div>
            </div>

        </div>

        <button id="submitSurveyButton" class="submit-survey-button">선택 완료</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const styleCards = document.querySelectorAll('.style-card');
            const submitButton = document.getElementById('submitSurveyButton');

            styleCards.forEach(card => {
                card.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });

            submitButton.addEventListener('click', async function() {
                const selectedStyles = [];
                document.querySelectorAll('.style-card.selected').forEach(card => {
                    selectedStyles.push(card.dataset.style);
                });

                console.log('Selected Styles:', selectedStyles);

                try {
                    const response = await fetch('/survey/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ styles: selectedStyles }),
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log('Survey submitted successfully:', result);
                        alert('설문조사가 성공적으로 제출되었습니다!');
                        // 제출 후 리다이렉트 또는 다른 작업 수행
                        // window.location.href = '/recommend/taste'; 
                    } else {
                        console.error('Failed to submit survey:', response.statusText);
                        alert('설문조사 제출에 실패했습니다.');
                    }
                } catch (error) {
                    console.error('Error submitting survey:', error);
                    alert('오류가 발생했습니다. 다시 시도해주세요.');
                }
            });
        });
    </script>
{% endblock %}
