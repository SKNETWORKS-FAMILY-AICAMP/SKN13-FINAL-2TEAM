{% extends "base.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', path='css/jjim.css') }}">
{% endblock %}

{% block content %}
<div class="modal-content">
    <h2>상품 비교</h2>
    {% if products %}
    <table class="comparison-table-modal">
        <thead>
            <tr>
                <th></th> {# Empty cell for attribute labels #}
                {% for product in products %}
                <th>
                    <img src="{{ product.image_url }}" alt="{{ product.product_name }}">
                </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>이름</td>
                {% for product in products %}
                <td>{{ product.product_name }}</td>
                {% endfor %}
            </tr>
            <tr>
                <td>브랜드</td>
                {% for product in products %}
                <td>{{ product.brand | default('브랜드 정보 없음') }}</td>
                {% endfor %}
            </tr>
            <tr>
                <td>가격</td>
                {% for product in products %}
                <td>{{ product.price }}원</td>
                {% endfor %}
            </tr>
            {# Add more rows for other attributes if needed #}
        </tbody>
    </table>
    {% else %}
    <p class="no-products-message">비교할 상품이 없습니다. 찜 목록에서 상품을 선택해주세요.</p>
    {% endif %}
    <button class="close-button" aria-label="Close modal">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Render stars based on rating
    document.querySelectorAll('.stars').forEach(starContainer => {
        const rating = parseFloat(starContainer.dataset.rating) || 0;
        const percentage = (rating / 5) * 100;
        starContainer.style.position = 'relative';
        starContainer.style.color = 'rgba(255, 255, 255, 0.2)'; // Empty stars color
        
        const filledStars = document.createElement('span');
        filledStars.textContent = '★★★★★';
        filledStars.style.position = 'absolute';
        filledStars.style.top = 0;
        filledStars.style.left = 0;
        filledStars.style.color = '#ffc700'; // Filled stars color
        filledStars.style.width = `${percentage}%`;
        filledStars.style.overflow = 'hidden';
        filledStars.style.whiteSpace = 'nowrap';

        starContainer.appendChild(filledStars);
    });
});
</script>
<script src="/static/js/compare_modal.js"></script>
{% endblock %}